{% extends "base.html" %}

{% block content %}
    <h2 class="mb-4">
        Cadastrar Novo Serviço para: 
        <a href="{{ url_for('show_vehicle', vehicle_id=vehicle.id) }}" class="text-decoration-none">
            {{ vehicle.model }} (Placa: {{ vehicle.plate }})
        </a>
    </h2>

    <form class="form" action="{{ url_for('create_service') }}" method="post">
        
        {# Campo oculto para garantir que o ID do veículo seja submetido #}
        <input type="hidden" name="vehicle_id" value="{{ vehicle.id }}">

        <div class="row">
            <div class="col-md-8 mb-3">
                <label for="description" class="form-label">Descrição do Serviço:</label>
                <textarea class="form-control" id="description" name="description" rows="3" required 
                       placeholder="Ex: Troca de óleo, Reparo de freio, Pintura..."></textarea>
            </div>
            
            <div class="col-md-4 mb-3">
                <label for="status_str" class="form-label">Status:</label>
                <select class="form-select" id="status_str" name="status_str" required>
                    {# --- CORREÇÃO AQUI: Itera sobre status_options e define o valor padrão --- #}
                    {% for status_value in status_options %}
                        <option value="{{ status_value }}" 
                                {% if status_value == 'PENDENTE' %}selected{% endif %}>
                            {{ status_value }}
                        </option>
                    {% endfor %}
                    {# ------------------------------------------------------------------------ #}
                </select>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4 mb-3">
                <label for="price" class="form-label">Preço Estimado (R$):</label>
                <input type="number" class="form-control" id="price" name="price" value="0.00" step="0.01" min="0">
            </div>
            
            <div class="col-md-8 mb-3">
                <label for="observations" class="form-label">Observações:</label>
                <textarea class="form-control" id="observations" name="observations" rows="3" 
                          placeholder="Detalhes adicionais do serviço..."></textarea>
            </div>
        </div>

        <div class="form-actions mt-4">
            <button type="submit" class="btn btn-success me-2">Cadastrar Serviço</button>
            <a href="{{ url_for('show_vehicle', vehicle_id=vehicle.id) }}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
{% endblock %}